<!DOCTYPE html>
<html id="html" class="{{ session.get("theme", "auto") }}" lang="en">
<head>
	<meta charset="UTF-8">
	<title>{{ title }} - {{ web_config["site-name"] }}</title>
	<link href="/css/{{ css }}" rel="stylesheet" type="text/css">

	<link rel=”mask-icon” href=”/favicon.svg” color=”#000000">
	<link rel="icon" href="/favicon.svg" type="image/svg+xml">
{#	<meta name="theme-color" content="#000000">#}

	<script type="text/javascript" src="/js/nav.js"></script>

	{% with messages = get_flashed_messages() %}
	   {% if messages %}
	      {% for message in messages %}
		      <script>alert("{{ message }}")</script>
	      {% endfor %}
	   {% endif %}
	{% endwith %}
</head>

<body id="body" class="{{ session.get("fontsize", "font_single") }}">
{% if frontpage is defined %}
	<div class="carousel" id="slider-container-outer">
		<div id="slider-container" class="slider-container-transition">
			{% for photo in photos %}
				<div class="slider-item" data-position="{{ loop.index }}"
				     style="background-image: url('/photo/{{ photo.photo_url }}');">
{#					<div>#}
{#						<h2>Our Last Show: <br>#}
{#							{{ latest_show.title }}</h2>#}
{#					</div>#}
					<img id="photo{{ loop.index }}"
					     src="/photo/{{ photo.photo_url }}"
					     alt="Photo"
					>
				</div>
			{% endfor %}
		</div>
	</div>
{% endif %}

<div class="title-bar">
	<div class="title">
		<a href="/" class="tooltip">
			{% if web_config.get("site_logo") is not none %}
				{{ web_config.get("site_logo").value | safe }}
			{% endif %}
			<h1>{{ web_config["site-name"] }}</h1>
			<span class="tooltip-text">Home</span>
		</a>
	</div>
	<div class="nav">
		{% for item in nav %}
			<a href="{{ item["link"] }}" class="{{ "active" if item["is_active"] }}"><h3>{{ item["title"] }}</h3></a>
		{% endfor %}
		<a href="/search" class="search"><svg viewbox="0 0 50 50">{{ icons["search"] | safe }}</svg></a>
		<a onclick="expand()" class="hamburger">
			<svg class="expand-icon collapsed search" id="menu-icon" viewBox="0 0 70 70"
			     preserveAspectRatio="xMidYMin">
				<path class="line one" d="m 15 19 l 45 0"></path>
				<path class="line two" d="m 15 35 l 45 0"></path>
				<path class="line three" d="m 15 51 l 45 0"></path>
			</svg>
		</a>
	</div>
</div>

<div class="collapsed" id="mobile-nav">
	{% for item in nav %}
		<a href="{{ item["link"] }}" class="{{ "active" if item["is_active"] }}"><h3>{{ item["title"] }}</h3></a>
	{% endfor %}
</div>


<div class="main-outer">
	{% if current_user.is_authenticated %}
        <div class="portal-nav">
			<a href="/members/dashboard"><h3>Dashboard</h3></a>
            <h3>Shows</h3>
            <ul class="dashboard-shows">
	            {% for m_show in m_shows %}
	                <li><a href="/members/show/{{ m_show.id }}">{{ m_show.title }}</a></li>
	            {% endfor %}
            </ul>

            {% if current_user.role in ["author", "admin"] %}
	            <h3>Blog Tools</h3>
	            <ul>
		            <li><a href="/members/manage-blog">Manage Blog</a></li>
		            <li><a href="/members">Create New Blog</a></li>
	            </ul>
            {% endif %}

            {% if current_user.role == "admin" %}
	            <h3>Admin Tools</h3>
	            <ul>
		            <li><a href="/members/manage_media">Manage Media</a></li>
		            <li><a href="/members/manage-shows">Manage Shows</a></li>
		            <li><a href="/members/set_show_photos/oauth">Update Photos</a></li>
		            <li><a href="/members/add-show-member">Add New Members</a></li>
		            <li><a href="/members/manage_users">Manage Users</a></li>
		            <li><a href="/members/admin_settings">Admin Settings</a></li>
	            </ul>
            {% endif %}

	        <a href="/members/account_settings"><h3>Account Settings</h3></a>
            {% if web_config.get("user_feedback_link") %}
	            <a href="{{ web_config.get("user_feedback_link") }}" target="_blank"><h3>Feedback Form</h3></a>
            {% endif %}
			<a href="/members/logout"><h3>Logout</h3></a>
		</div>
	{% endif %}

	<div class="main-section">
		<div class="content">
			{% block content %}
			{% endblock %}
		</div>

		<div class="sidebar">
			{# tickets #}
			{% if web_config.get("tickets-active") == "1" %}
				<div class="tickets">
					<h2>Tickets Available:</h2>
					<a href="/tickets" target="_blank">Purchase Tickets</a>
				</div>
			{% endif %}

			{# socials #}
			{% if True %}
				<div class="socials">
					<h2>Socials:</h2>
					{% for link in socials %}
						<a class="{{ link["type"] }}" href="https://{{ link["link"] }}" target="_blank" rel="noopener noreferrer">
							<span class="icon"><svg viewbox="0 0 50 50">{{ link["icon"] | safe }}</svg></span>
							<span class="text">{{ link["text"] }}</span>
						</a>
					{% endfor %}
				</div>
			{% endif %}

			{# latest blog #}
			{% if web_config.get("latest_blog") is not none %}
				<div class="generic_link">
					<h2>Latest Blog: {{ web_config.get("latest_blog")[0] }}</h2>
{#					<a href="/blog/latest"><h3></h3></a>#}
					<a class="generic_link" href="/blog/latest">
						<span class="icon"><svg viewbox="0 0 50 50">{{ icons["blog_icon"] | safe }}</svg></span>
						<span class="text">{{ web_config.get("latest_blog")[1] }}</span>
					</a>
				</div>
			{% endif %}

			{# last show #}
			{% if web_config.get("last_show") is not none %}
				<div class="generic_link">
					<h2>Our Last Show</h2>
					<a class="generic_link" href="{{ web_config.get("last_show")[1] }}">
						<span class="icon"><svg viewbox="0 0 50 50">{{ icons["drama"] | safe }}</svg></span>
						<span class="text">{{ web_config.get("last_show")[0] }}</span>
					</a>
				</div>
			{% endif %}
		</div>
	</div>
</div>

<div class="footer">
	<div>
		<strong>Powered By:</strong>
		<div>Open AmDram Portal</div>
		<div><a href="https://github.com/mattl1598/open-amdram-portal">github.com/mattl1598/open-amdram-portal</a></div>
		<div>Opensource</div>
	</div>
	<div class="accessibility">
		<strong>Accessibility</strong>
		<span>
			<select name="theme" id="theme" onchange="window.location.assign('/accessibility?theme='+this.value)" selected="font_single">
				<option value="auto" {{ "selected" if session.get("theme", "auto") == "auto" }}>Theme: Auto</option>
				<option value="light" {{ "selected" if session.get("theme", "auto") == "light" }}>Theme: Light</option>
				<option value="dark" {{ "selected" if session.get("theme", "auto") == "dark" }}>Theme: Dark</option>
			</select>
		</span>
		<span>
			<label for="">Font Size</label>
			<button id="font_single" type=button onclick="window.location.assign('/accessibility?fontsize=font_single')">1x</button>
			<button id="font_double" type=button onclick="window.location.assign('/accessibility?fontsize=font_double')">1.5x</button>
			<button id="font_triple" type=button onclick="window.location.assign('/accessibility?fontsize=font_triple')">2x</button>
		</span>
	</div>
</div>
</body>
	{% if modules is defined %}
		{% if modules["wysiwyg"] %}
			<link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
			<script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
		{% endif %}
		{% if modules["tom-select"] %}
			<link href="https://cdn.jsdelivr.net/npm/tom-select@latest/dist/css/tom-select.css" rel="stylesheet">
			<script src="https://cdn.jsdelivr.net/npm/tom-select@latest/dist/js/tom-select.complete.min.js"></script>
		{% endif %}
	{% endif %}
	{% if js is defined %}
		<script type="text/javascript" src="/js/{{ js }}"></script>
	{% endif %}
</html>